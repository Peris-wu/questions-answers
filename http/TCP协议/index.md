## TCP 协议

tcp 协议是面向连接，可靠的，基于字节流传输的传输层协议
全双工：允许数据在两个方向上同时传输
半双工：同一时间数据只能在一个方向传输

## 三次握手（目的为了确定客户端与服务端的收发能力）

1: 客户端想服务端发送一个 SYN（建立联机）报文，并初始化序列号 SEQ,此时客户端进入 SYN_SENT 状态
2: 服务端收到 SYN 报文后，会像客户端响应一个 SYN+ACK 报文，初始化序列号 SEQ，ack（确认号）= 客户端的序列号+1，此时服务端进入了 SYN_RCVD 状态
3: 客户端收到响应报文后，会向服务端发送一个 ACK 报文,序列号 SEQ 为响应报文的 ack 确认号，确认号 ack 为服务端序列号+1 此时客户端进入 ESTABLISHED（连接已建立状态）,服务端收到 ACK 报文后，也进入 ESTABLISHED（连接已建立状态）。

## 四次挥手(客户端数据传输完毕了，需要关闭连接)

1: 客户端向服务端发送一个 FIN+ACK（确认结束）报文,序列号 SEQ 为上一个响应报文(前面多次的 http 请求，序列号和确认号都已经累加了 ) ack 确认号,确认号 ack 为上一个响应报文的序列号 seq+1,然后进入 FIN_WAIT 状态
2: 服务端收到 FIN 报文后，立即做出响应,向客户端发送一个 ACK 确认报文,序列号为 FIN+ACK 报文 ack 确认号,ack 确认号为请求报文序列号+1,然后进入 CLOSE_WAIT 状态
3: 过一段时间后，服务端接收完数据后，向客户端响应 FIN+ACK 报文，ack 确认号、序列号不变，跟上一次服务端响应的一样,然后进入 lack_ack 状态
4: 客户端收到 FIN+ACK 响应报文后，会向服务端发送一个 ACK 确认报文，序列号为对方确认号，确认号为对方序列号+1，然后进入一个 2MSL 等待状态,服务端收到后，进入关闭状态,如果服务端等待 2msl 后没有再次收到 FIN+ACK 报文，则就关闭连接，如果没收到，则服务端会再次发送 ACK+FIN 报文
